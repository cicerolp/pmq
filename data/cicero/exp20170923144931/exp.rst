===================================
Benchmark Queries - Twitter Dataset
===================================


.. contents::

1 Description
-------------

Test the queries on Twitter Dataset. 
And compare the following performances.

- PMQ / GEOHASH

- BTREE

- RTREE - quadratic algorithm

- RTREE - quadratic algorithm with bulk loading

Use the refinement level = 8 

Elements:

- Timewindow = 26000

- Batch size = 1000

- Total elements = 26.000.000

Use the syntehic queries gerenerate by the DoE in `Twitter Data <../../queriesLHS.rst>`_.

queries Dataset : `../../queriesTwitter.csv <../../queriesTwitter.csv>`_.

2 Analysis
----------

2.1 Results
~~~~~~~~~~~

2.1.1 Plot overview
^^^^^^^^^^^^^^^^^^^

.. image:: ./img/overview_query_region.png

2.1.2 Plot ordered by query return size
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Count queries

.. image:: ./img/count_queries_by_size.png

Scan queries: 

.. image:: ./img/scan_queries_by_size.png

2.1.3 Comments
^^^^^^^^^^^^^^

- PMQ seems to be the best algorithmn when the amount of elements returned by the query is large.

See table in `tab20170923185752`_.

.. _tab20170923185752:

2.2 What is the actual count of elements per query ?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

2.2.1 Table
^^^^^^^^^^^

Variance shows if some counts differ between algorithms:
(all the algorithms had the same counts for every query)

.. table::

    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    | queryId | BTree\_Count | GeoHashBinary\_Count | ImplicitDenseVector\_Count | RTreeBulk\_Count | RTree\_Count | Var |
    +=========+==============+======================+============================+==================+==============+=====+
    |       0 |     24178715 |             24178715 |                   24178715 |         24178715 |     24178715 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       1 |     24320314 |             24320314 |                   24320314 |         24320314 |     24320314 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       2 |     19754592 |             19754592 |                   19754592 |         19754592 |     19754592 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       3 |     25763943 |             25763943 |                   25763943 |         25763943 |     25763943 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       4 |     24307788 |             24307788 |                   24307788 |         24307788 |     24307788 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       5 |     24131410 |             24131410 |                   24131410 |         24131410 |     24131410 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       6 |     25763888 |             25763888 |                   25763888 |         25763888 |     25763888 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       7 |     24648489 |             24648489 |                   24648489 |         24648489 |     24648489 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       8 |     25763951 |             25763951 |                   25763951 |         25763951 |     25763951 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |       9 |     24556041 |             24556041 |                   24556041 |         24556041 |     24556041 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      10 |     22266461 |             22266461 |                   22266461 |         22266461 |     22266461 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      11 |     22255409 |             22255409 |                   22255409 |         22255409 |     22255409 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      12 |      7561928 |              7561928 |                    7561928 |          7561928 |      7561928 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      13 |     21465987 |             21465987 |                   21465987 |         21465987 |     21465987 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      14 |     20823150 |             20823150 |                   20823150 |         20823150 |     20823150 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      15 |       172485 |               172485 |                     172485 |           172485 |       172485 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      16 |     21867218 |             21867218 |                   21867218 |         21867218 |     21867218 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      17 |     21899103 |             21899103 |                   21899103 |         21899103 |     21899103 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      18 |      6746852 |              6746852 |                    6746852 |          6746852 |      6746852 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      19 |     21863148 |             21863148 |                   21863148 |         21863148 |     21863148 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      20 |      1720216 |              1720216 |                    1720216 |          1720216 |      1720216 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      21 |      3656734 |              3656734 |                    3656734 |          3656734 |      3656734 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      22 |      3239932 |              3239932 |                    3239932 |          3239932 |      3239932 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      23 |      3359208 |              3359208 |                    3359208 |          3359208 |      3359208 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      24 |     16754579 |             16754579 |                   16754579 |         16754579 |     16754579 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      25 |     10500916 |             10500916 |                   10500916 |         10500916 |     10500916 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      26 |     14436603 |             14436603 |                   14436603 |         14436603 |     14436603 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      27 |      5949544 |              5949544 |                    5949544 |          5949544 |      5949544 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      28 |     12512448 |             12512448 |                   12512448 |         12512448 |     12512448 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      29 |      5363962 |              5363962 |                    5363962 |          5363962 |      5363962 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      30 |      2933887 |              2933887 |                    2933887 |          2933887 |      2933887 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      31 |      6357856 |              6357856 |                    6357856 |          6357856 |      6357856 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      32 |      5622730 |              5622730 |                    5622730 |          5622730 |      5622730 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      33 |      7882904 |              7882904 |                    7882904 |          7882904 |      7882904 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      34 |      4453847 |              4453847 |                    4453847 |          4453847 |      4453847 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      35 |      2771423 |              2771423 |                    2771423 |          2771423 |      2771423 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      36 |      6580851 |              6580851 |                    6580851 |          6580851 |      6580851 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      37 |      4879016 |              4879016 |                    4879016 |          4879016 |      4879016 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      38 |      2969182 |              2969182 |                    2969182 |          2969182 |      2969182 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      39 |      2779782 |              2779782 |                    2779782 |          2779782 |      2779782 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      40 |       923319 |               923319 |                     923319 |           923319 |       923319 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      41 |       932176 |               932176 |                     932176 |           932176 |       932176 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      42 |       284653 |               284653 |                     284653 |           284653 |       284653 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      43 |      1944583 |              1944583 |                    1944583 |          1944583 |      1944583 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      44 |       428643 |               428643 |                     428643 |           428643 |       428643 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      45 |       290775 |               290775 |                     290775 |           290775 |       290775 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      46 |      1192366 |              1192366 |                    1192366 |          1192366 |      1192366 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      47 |       448450 |               448450 |                     448450 |           448450 |       448450 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      48 |      5230730 |              5230730 |                    5230730 |          5230730 |      5230730 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      49 |      2018612 |              2018612 |                    2018612 |          2018612 |      2018612 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      50 |      2443223 |              2443223 |                    2443223 |          2443223 |      2443223 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      51 |        61318 |                61318 |                      61318 |            61318 |        61318 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      52 |      2853477 |              2853477 |                    2853477 |          2853477 |      2853477 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      53 |      1024119 |              1024119 |                    1024119 |          1024119 |      1024119 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      54 |       173015 |               173015 |                     173015 |           173015 |       173015 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      55 |      1838813 |              1838813 |                    1838813 |          1838813 |      1838813 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      56 |       897456 |               897456 |                     897456 |           897456 |       897456 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      57 |      2936650 |              2936650 |                    2936650 |          2936650 |      2936650 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      58 |       912272 |               912272 |                     912272 |           912272 |       912272 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      59 |      2171693 |              2171693 |                    2171693 |          2171693 |      2171693 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      60 |         9615 |                 9615 |                       9615 |             9615 |         9615 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      61 |       447052 |               447052 |                     447052 |           447052 |       447052 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      62 |       559470 |               559470 |                     559470 |           559470 |       559470 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      63 |       144198 |               144198 |                     144198 |           144198 |       144198 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      64 |       146267 |               146267 |                     146267 |           146267 |       146267 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      65 |        38191 |                38191 |                      38191 |            38191 |        38191 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      66 |       561318 |               561318 |                     561318 |           561318 |       561318 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      67 |       327875 |               327875 |                     327875 |           327875 |       327875 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      68 |       204817 |               204817 |                     204817 |           204817 |       204817 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      69 |       186626 |               186626 |                     186626 |           186626 |       186626 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      70 |       777466 |               777466 |                     777466 |           777466 |       777466 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      71 |        41667 |                41667 |                      41667 |            41667 |        41667 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      72 |       180284 |               180284 |                     180284 |           180284 |       180284 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      73 |       558507 |               558507 |                     558507 |           558507 |       558507 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      74 |       125097 |               125097 |                     125097 |           125097 |       125097 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      75 |       594165 |               594165 |                     594165 |           594165 |       594165 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      76 |         6091 |                 6091 |                       6091 |             6091 |         6091 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      77 |       302551 |               302551 |                     302551 |           302551 |       302551 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      78 |       184109 |               184109 |                     184109 |           184109 |       184109 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
    |      79 |       173799 |               173799 |                     173799 |           173799 |       173799 |   0 |
    +---------+--------------+----------------------+----------------------------+------------------+--------------+-----+
